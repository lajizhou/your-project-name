<template>
  <!-- å¤–å±‚å®¹å™¨ï¼šå®ç°ä¾§è¾¹æ +ä¸»å†…å®¹åŒºçš„å¸ƒå±€ -->
  <el-container style="height: 100vh">
    <!-- å·¦ä¾§å¯¼èˆªæ  -->
    <el-aside width="200px" style="background-color: #2e3b4e; color: #fff">
      <!-- å¯¼èˆªèœå• -->
      <el-menu
        default-active="1"
        class="el-menu-vertical-demo"
        background-color="#2e3b4e"
        text-color="#fff"
        active-text-color="#ffd04b"
        unique-opened
      >
        <!-- å¯¼èˆªé¡¹1 -->
        <el-menu-item index="1">
          <i class="el-icon-menu"></i>
          <span slot="title">å¼‚å¸¸ç ”åˆ¤</span>
        </el-menu-item>
        <!-- å¯¼èˆªé¡¹2ï¼šå‘˜å·¥ç®¡ç†ï¼ˆå¯¹åº”å½“å‰é¡µé¢åŠŸèƒ½ï¼‰ -->
        <el-menu-item index="2">
          <i class="el-icon-user"></i>
          <span slot="title">å‘˜å·¥ç®¡ç†</span>
        </el-menu-item>
        <!-- å¯¼èˆªé¡¹3ï¼šéƒ¨é—¨ç®¡ç† -->
        <el-menu-item index="3">
          <i class="el-icon-office-building"></i>
          <span slot="title">éƒ¨é—¨ç®¡ç†</span>
        </el-menu-item>
        <!-- æŠ˜å å¯¼èˆªé¡¹ï¼ˆåŒ…å«å­èœå•ï¼‰ -->
        <el-submenu index="4">
          <template slot="title">
            <i class="el-icon-setting"></i>
            <span>ç³»ç»Ÿè®¾ç½®</span>
          </template>
          <el-menu-item index="4-1">åŸºç¡€é…ç½®</el-menu-item>
          <el-menu-item index="4-2">æƒé™ç®¡ç†</el-menu-item>
        </el-submenu>
      </el-menu>
    </el-aside>

    <!-- å³ä¾§ä¸»å†…å®¹åŒºï¼ˆåŸæœ‰åŠŸèƒ½å†…å®¹ï¼‰ -->
    <el-main v-if="showTime == '1'">
      <div class="app-container">
        <el-tabs v-model="activeName" @tab-click="handleClick">
          <el-tab-pane label="ç”µé‡å¼‚å¸¸ç ”åˆ¤" name="first"></el-tab-pane>
          <el-tab-pane label="ç”µè´¹å¼‚å¸¸ç ”åˆ¤" name="second"></el-tab-pane>
        </el-tabs>
        <!-- 1. æŸ¥è¯¢è¡¨å• -->
        <el-form inline @submit.prevent="search">
          <el-form-item label="ç”¨æˆ·åç§°">
            <el-input
              v-model="queryKey"
              placeholder="è¾“å…¥å§“å/èŒä½æŸ¥è¯¢"
              style="width: 200px"
            />
          </el-form-item>
          <el-form-item label="ç”¨æˆ·ç¼–å·">
            <el-input
              v-model="userNamber"
              placeholder="è¾“å…¥å§“å/èŒä½æŸ¥è¯¢"
              style="width: 200px"
            />
          </el-form-item>
          <el-form-item label="ç”µå‹ç­‰çº§">
            <el-select v-model="voltageLevel" placeholder="è¯·é€‰æ‹©">
              <el-option
                v-for="item in options"
                :key="item.value"
                :label="item.label"
                :value="item.value"
              >
              </el-option>
            </el-select>
          </el-form-item>
          <el-form-item label="ä¾›ç”µå•ä½">
            <el-select v-model="powerSupplyUnit" placeholder="è¯·é€‰æ‹©">
              <el-option
                v-for="item in options"
                :key="item.value"
                :label="item.label"
                :value="item.value"
              >
              </el-option>
            </el-select>
          </el-form-item>
          <el-form-item label="æ—¥æœŸ">
            <el-date-picker v-model="date" type="date" placeholder="é€‰æ‹©æ—¥æœŸ">
            </el-date-picker>
          </el-form-item>
          <el-form-item>
            <el-button type="primary" @click="search">æŸ¥è¯¢</el-button>
            <el-button @click="reset">é‡ç½®</el-button>
          </el-form-item>
        </el-form>

        <!-- 2. è¡¨æ ¼å±•ç¤º -->
        <el-table
          :data="tableData"
          border
          style="width: 100%; margin-top: 20px"
          stripe
        >
          <el-table-column label="åºå·" align="center" width="60">
            <template #default="scope">
              {{ scope.$index + 1 }}
            </template>
          </el-table-column>
          <el-table-column prop="mgtOrgName" label="ä¾›ç”µå•ä½" width="180" />
          <el-table-column prop="chkCalcPic" label="æ ¸ç®—åŒ…ç¼–å·" width="120" />
          <el-table-column prop="userId" label="ç”¨æˆ·ç¼–å·" width="150" />
          <el-table-column
            prop="name"
            label="ç”¨æˆ·åç§°"
            width="80"
            align="center"
          />
          <el-table-column
            prop="abnormal"
            label="æ˜¯å¦å¼‚å¸¸"
            width="80"
            align="center"
          />
          <el-table-column
            prop="ruleTriggered"
            label="è§¦å‘å®¡æ ¸è§„åˆ™"
            width="150"
          />
          <el-table-column
            prop="ruleName"
            label="è§„åˆ™åç§°"
            width="220"
            align="center"
          />
          <el-table-column prop="position" label="è¡Œä¸šç±»åˆ«" width="150" />
          <el-table-column prop="department" label="ç”µå‹ç­‰çº§" />
          <el-table-column prop="yearMonth" label="å¼‚å¸¸å¹´æœˆ" width="180" />
          <el-table-column
            v-if="activeName == 'first'"
            prop="thisMonthQty"
            label="æœ¬æœˆç”µé‡"
            width="180"
          />
          <el-table-column
            v-if="activeName == 'first'"
            prop="lastMonthQty"
            label="ä¸Šæœˆç”µé‡"
            width="180"
          />
          <el-table-column
            v-if="activeName == 'first'"
            prop="lastMonusQty"
            label="æ¯”ä¸Šæœˆç”µé‡å¢å‡é‡"
            width="180"
          />
          <el-table-column
            v-if="activeName == 'first'"
            prop="lastMonthRate"
            label="æ¯”ä¸Šæœˆç”µé‡æ³¢åŠ¨ç‡"
            width="180"
          />
          <el-table-column
            v-if="activeName == 'second'"
            prop="thisMonthQty"
            label="æœ¬æœˆç”µè´¹"
            width="180"
          />
          <el-table-column
            v-if="activeName == 'second'"
            prop="lastMonthQty"
            label="ä¸Šæœˆç”µè´¹"
            width="180"
          />
          <el-table-column
            v-if="activeName == 'second'"
            prop="lastMonusQty"
            label="æ¯”ä¸Šæœˆç”µè´¹å¢å‡é‡"
            width="180"
          />
          <el-table-column
            v-if="activeName == 'second'"
            prop="lastMonthRate"
            label="æ¯”ä¸Šæœˆç”µè´¹æ³¢åŠ¨ç‡"
            width="180"
          />
          <el-table-column fixed="right" label="æ“ä½œ" width="100">
            <template slot-scope="scope">
              <el-button
                @click="handleDetail(scope.row)"
                type="text"
                size="small"
                >ç ”åˆ¤</el-button
              >
            </template>
          </el-table-column>
        </el-table>
        <el-pagination
          style="text-align: end; margin-top: 12px"
          background
          layout="prev, pager, next"
          :total="1000"
        >
        </el-pagination>
      </div>
    </el-main>
    <el-main style="background: #fff" v-if="showTime == '2'">
      <div>
        <el-descriptions title="ç”¨æˆ·ä¿¡æ¯">
          <el-descriptions-item label="ç”¨æˆ·åç§°">{{
            rowObj.name
          }}</el-descriptions-item>
          <el-descriptions-item label="ç”µå‹ç­‰çº§">{{
            rowObj.mgtOrgName
          }}</el-descriptions-item>
          <el-descriptions-item label="ç”¨æˆ·ç¼–å·">{{
            rowObj.userId
          }}</el-descriptions-item>
          <el-descriptions-item label="æ ¸ç®—åŒ…ç¼–å·">
            <el-tag size="small">{{ rowObj.chkCalcPic }}</el-tag>
          </el-descriptions-item>
          <el-descriptions-item label="è¡Œä¸šç±»åˆ«"
            >{{ rowObj.position }}
          </el-descriptions-item>
          <el-descriptions-item label="æ˜¯å¦å¼‚å¸¸">{{
            rowObj.abnormal
          }}</el-descriptions-item>
        </el-descriptions>
        <div>
          <div
            class="border-content"
            style="height: 25px; width: 100px"
            v-if="borderShow == '1'"
            @click="borderClick"
          >
            åˆ†æè¿‡ç¨‹<i style="margin-left: 12px" class="el-icon-edit"></i>
          </div>
          <div
            v-if="borderShow == '2'"
            class="border-content"
            @click="bordersClick"
          >
            <div>
              åˆ†æè¿‡ç¨‹<i style="margin-left: 12px" class="el-icon-edit"></i>
            </div>
            <div style="height: 300px; overflow: auto">
              ç”µèƒ½è¡¨ç¤ºæ•°å¼‚å¸¸ç ”åˆ¤æŠ¥å‘Šï¼š ä¸€ã€å¼‚å¸¸åŸºæœ¬ä¿¡æ¯ é¡¹ç›® å†…å®¹ ç”¨æˆ·ç¼–å· ï¼š
              062170001751478 è®¡é‡ç‚¹ç¼–å· 0621700017514781 ç”¨æˆ·åç§° æœªæä¾›
              å®¡æ ¸è§„åˆ™ç¼–å· TY-QW-DL-SS-06 è§„åˆ™åç§° ç”µèƒ½è¡¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•°
              å¼‚å¸¸ç”µè´¹å¹´æœˆ 202512ï¼ˆ2025å¹´12æœˆï¼‰
              äºŒã€ç ”åˆ¤ç»“è®ºå­˜åœ¨çœŸå®å¼‚å¸¸ã€‚ç»æ ¸æŸ¥ç¡®è®¤ï¼Œè¯¥è®¡é‡ç‚¹2025å¹´12æœˆæŠ„è¡¨æ•°æ®å­˜åœ¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•°çš„è¿è§„æƒ…å†µï¼Œå±äºäººå·¥æŠ„å½•é”™è¯¯å¯¼è‡´çš„å¼‚å¸¸ã€‚
              ä¸‰ã€åˆ¤æ–­è¿‡ç¨‹å’Œä¾æ® æ•°æ®éªŒè¯ 2025å¹´12æœˆæŠ„è¡¨æ•°æ®ï¼š
              ä¸Šæ¬¡è¡¨ç¤ºæ•°ï¼š150.12 æœ¬æ¬¡è¡¨ç¤ºæ•°ï¼š149.34 è¡¨ç¤ºæ•°å·®é¢ï¼š0.78ï¼ˆæ­£å‘ç”µé‡ï¼‰
              æŠ„è¡¨å¼‚å¸¸ç±»åˆ«ï¼šå€’è½¬ å®é™…æŠ„è¡¨æ–¹å¼ï¼šæ‰‹å·¥æŠ„è¡¨. 2025å¹´11æœˆå¯¹æ¯”æ•°æ®ï¼š
              ä¸Šæ¬¡è¡¨ç¤ºæ•°ï¼š121.53 æœ¬æ¬¡è¡¨ç¤ºæ•°ï¼š150.12 æŠ„è¡¨æ–¹å¼ï¼šè¿œé‡‡é›†æŠ„
              è§„åˆ™åŒ¹é…åˆ†ænæ ¹æ®ã€ŠXXçœ-ç»Ÿæ¨è§„åˆ™æ€ç»´é“¾æ ‡æ³¨0527.xlsxã€‹ä¸­è§„åˆ™TY-QW-DL-SS-06çš„ç ”åˆ¤é€»è¾‘ï¼š
              è§¦å‘æ¡ä»¶ï¼šç»“ç®—è®¡é‡ç‚¹ä¸‹ç”µèƒ½è¡¨ç¤ºæ•°æœ¬æ¬¡å°äºä¸Šæ¬¡ï¼Œä¸”æŠ„è¡¨å¼‚å¸¸ç±»åˆ«â‰ 07ï¼ˆå¤±å‹ï¼‰-
              æ‰‹å·¥æŠ„è¡¨åœºæ™¯åˆ¤å®šï¼š
              å½“å®é™…æŠ„è¡¨æ–¹å¼ä¸ºæ‰‹å·¥æŠ„è¡¨æ—¶ï¼Œæœ¬æ¬¡ç¤ºæ•°ä¸Šæ¬¡ç¤ºæ•°ç›´æ¥åˆ¤å®šä¸ºå¼‚å¸¸
              æœ¬ä¾‹ä¸­æŠ„è¡¨æ–¹å¼æ˜ç¡®è®°å½•ä¸º"æ‰‹å·¥æŠ„è¡¨"ä¸”æœ¬æ¬¡ç¤ºæ•°149.34 ä¸Šæ¬¡ç¤ºæ•°150.12
              è¿å"ä¸å¾—è¿è§„ä¼°æŠ„ã€æ¼æŠ„ã€é”™æŠ„"çš„åŸºæœ¬åŸåˆ™ æ”¿ç­–åˆè§„æ€§éªŒè¯n1.
              å›½ç½‘è¥é”€è¥ä¸š62å·æ–‡ç¬¬äºŒåä¸ƒæ¡ç¬¬å››æ¬¾ï¼š >
              "åŸåˆ™ä¸Šä¸å…è®¸æ‰‹å·¥å½•å…¥ï¼Œç‰¹æ®Šæƒ…å†µç¡®éœ€æ‰‹å·¥å½•å…¥çš„ï¼Œåº”ç”±å·¥ä½œäººå‘˜ç°åœºæŠ„å½•ã€æ‹ç…§ï¼Œå¹¶é€šè¿‡ç”¨ç”µä¿¡æ¯é‡‡é›†ç³»ç»Ÿä¸Šä¼ è¡¨è®¡ç¤ºæ•°ç…§ç‰‡ç­‰ä½è¯ææ–™ï¼Œå±¥è¡Œå®¡æ ¸æ‰‹ç»­
              Xç”µè¥é”€è§„ã€”2025ã€•4å·æ–‡ç¬¬äºŒåäº”æ¡ï¼š >
              "æŠ„è¡¨å‘¨æœŸå’ŒæŠ„è¡¨ä¾‹æ—¥åŸåˆ™ä¸Šä¸å…è®¸å˜æ›´...æŠ„è¡¨ç»“æŸå°†æ‰‹å·¥æŠ„å½•æ•°æ®å‡†ç¡®æ€§çº³å…¥è¥é”€ç¨½æŸ¥ä¸šåŠ¡èŒƒå›´"ç»“è®ºä¾æ®ï¼šè¯¥æ¡ˆä¾‹æ—¢æ— ä½è¯ææ–™ä¸Šä¼ è®°å½•ï¼Œä¹Ÿæœªå±¥è¡Œç‰¹æ®Šå®¡æ‰¹æ‰‹ç»­ï¼Œå±äºè¿è§„æ“ä½œã€‚
              å››ã€å¼‚å¸¸åŸå› åˆ†æn1. ç›´æ¥åŸå› ï¼š
              æŠ„è¡¨äººå‘˜åœ¨æ‰‹å·¥æŠ„å½•è¿‡ç¨‹ä¸­å‘ç”Ÿè¯»æ•°é”™è¯¯ï¼Œå°†150.34è¯¯è®°ä¸º149.34ï¼ˆæˆ–ç±»ä¼¼æ•°å­—æ··æ·†ï¼‰
              - æœªæ‰§è¡Œ"ç°åœºæŠ„å½•ã€æ‹ç…§ä¸Šä¼ "çš„å¼ºåˆ¶è¦æ±‚. ç®¡ç†æ¼æ´ï¼š
              æ‰‹å·¥æŠ„è¡¨ç¯èŠ‚ç¼ºä¹æœ‰æ•ˆçš„åŒäººå¤æ ¸æœºåˆ¶
              ç³»ç»Ÿæœªå¯¹äººå·¥å½•å…¥æ•°æ®è®¾ç½®é˜ˆå€¼é¢„è­¦ï¼ˆå¦‚ç¤ºæ•°ä¸‹é™è¶…è¿‡1%è‡ªåŠ¨æ‹¦æˆªï¼‰
              æŠ„è¡¨è´¨é‡ç®¡æ§æœªè½å®"è°å‡ºå£ã€è°è´Ÿè´£"åŸåˆ™n3. æŠ€æœ¯å› ç´ ï¼š
              ä»è¿œé‡‡é›†æŠ„çªç„¶è½¬ä¸ºæ‰‹å·¥æŠ„è¡¨ï¼ˆ11æœˆä¸ºè¿œé‡‡ï¼Œ12æœˆä¸ºæ‰‹å·¥ï¼‰ï¼Œæœªè¿›è¡Œè®¡é‡è£…ç½®çŠ¶æ€æ£€æŸ¥
              - æœªè¯†åˆ«ç”µè¡¨æ˜¯å¦å­˜åœ¨æœºæ¢°æ•…éšœå¯¼è‡´ç¤ºæ•°å¼‚å¸¸ äº”ã€å¤„ç†æªæ–½å’Œæ–¹æ¡ˆå»ºè®®
              ç´§æ€¥å¤„ç½®n1. ç°åœºå¤æ ¸ï¼š 24å°æ—¶å†…å®‰æ’ä¸¤åå·¥ä½œäººå‘˜ç°åœºæ ¸å¯¹ç”µè¡¨ç¤ºæ•°
              æ‹æ‘„å¸¦æ—¶é—´æ°´å°çš„è¡¨è®¡ç…§ç‰‡ä½œä¸ºæ–°è¯æ®é“¾. æ•°æ®ä¿®æ­£ï¼š
              è‹¥ç¡®è®¤æŠ„å½•é”™è¯¯ï¼ŒæŒ‰æ­£ç¡®ç¤ºæ•°é‡æ–°è®¡ç®—ç”µè´¹
              åœ¨ç³»ç»Ÿä¸­æ ‡æ³¨"äººå·¥ä¿®æ­£"å¹¶ç•™å­˜å®¡æ‰¹è®°å½• é•¿æ•ˆæœºåˆ¶ æªæ–½ç±»åˆ« å…·ä½“æ–¹æ¡ˆ
              -------------------- æµç¨‹ä¼˜åŒ–
              å»ºç«‹æ‰‹å·¥æŠ„è¡¨"åŒäººç¡®è®¤+å½±åƒä¸Šä¼ "å¼ºåˆ¶æµç¨‹ï¼Œç³»ç»Ÿè‡ªåŠ¨æ ¡éªŒå½±åƒå®Œæ•´æ€§
              æŠ€æœ¯é˜²æ§
              åœ¨é‡‡é›†ç³»ç»Ÿå¢åŠ ç¤ºæ•°çªå˜é¢„è­¦æ¨¡å—ï¼ˆè®¾ç½®Â±5%é˜ˆå€¼ï¼‰ï¼Œè‡ªåŠ¨å†»ç»“å¼‚å¸¸æ•°æ®
              è´£ä»»è¿½æº¯
              å°†æŠ„è¡¨å·®é”™çº³å…¥ç»©æ•ˆè€ƒæ ¸ï¼Œå®è¡Œ"å·®é”™æº¯æº-è´£ä»»è®¤å®š-ç»æµå¤„ç½š"é—­ç¯ç®¡ç†
              åŸ¹è®­å¼ºåŒ– å¼€å±•æŠ„è¡¨äººå‘˜ä¸“é¡¹åŸ¹è®­ï¼Œé‡ç‚¹å¼ºåŒ–æ•°å­—è¯†åˆ«èƒ½åŠ›å’Œè§„èŒƒæ“ä½œæ„è¯†
              é€€è¡¥æ–¹æ¡ˆn1. æŒ‰ã€Šè¥ä¸šå·®é”™é€€è¡¥ç®¡ç†åŠæ³•ã€‹å¯åŠ¨é€€è¡¥æµç¨‹. è®¡ç®—å…¬å¼ï¼š
              `åº”é€€è¡¥ç”µè´¹ = (æ­£ç¡®ç¤ºæ•° - é”™è¯¯ç¤ºæ•°) Ã— ç»¼åˆå€ç‡ Ã— ç”µä»·` `= (150.34
              - 149.34) Ã— 1 Ã— 38.99å…ƒ/kWh = 38.99å…ƒ`.
              3ä¸ªå·¥ä½œæ—¥å†…å®Œæˆå®¢æˆ·æ²Ÿé€šå’Œè´¦åŠ¡è°ƒæ•´ å…­ã€ç›¸å…³æ–‡ä»¶åŠæ³•å’Œè§„å®šn1.
              æ ¸å¿ƒä¾æ®ï¼š
              ã€Šå›½ç½‘è¥é”€éƒ¨å…³äºå°å‘ã€ˆç”µè´¹ä¸šåŠ¡ç®¡ç†åŠæ³•ï¼ˆè¯•è¡Œï¼‰ã€‰çš„é€šçŸ¥ã€‹ï¼ˆè¥é”€è¥ä¸šã€”2023ã€•62å·ï¼‰
              - ç¬¬äºŒåå…­æ¡ï¼šæŠ„è¡¨æ•°æ®"è°å‡ºå£ã€è°è´Ÿè´£"è´¨é‡ç®¡ç†è¦æ±‚
              ç¬¬äºŒåä¸ƒæ¡ç¬¬å››æ¬¾ï¼šæ‰‹å·¥æŠ„è¡¨çš„ç‰¹æ®Šç®¡ç†è§„å®š
              ç¬¬äº”åå…«æ¡ï¼šè¥ä¸šå·®é”™é€€è¡¥å¤„ç†è§„èŒƒ. åœ°æ–¹å®æ–½ç»†åˆ™ï¼š
              ã€Šå›½ç½‘XXçœç”µåŠ›æœ‰é™å…¬å¸ç”µè´¹æ ¸ç®—ç®¡ç†åŠæ³•ã€‹ï¼ˆXç”µè¥é”€è§„ã€”2025ã€•4å·ï¼‰
              ç¬¬äºŒåå››æ¡ï¼šæ‰‹å·¥æŠ„è¡¨æ•°æ®å¿…é¡»é™„å½±åƒä½è¯
              ç¬¬äºŒåäº”æ¡ï¼šæŠ„è¡¨è´¨é‡çº³å…¥è¥é”€ç¨½æŸ¥èŒƒå›´n3. é…å¥—æ ‡å‡†ï¼š
              ã€Šç”¨ç”µä¿¡æ¯é‡‡é›†ç³»ç»Ÿè¿è¡Œç»´æŠ¤è§„ç¨‹ã€‹Q/GDW 12202-2024
              ã€Šç”µåŠ›è¥é”€ç°åœºä½œä¸šå®‰å…¨å·¥ä½œè§„ç¨‹ã€‹Q/GDW 1799.2-2023>
              å¤‡æ³¨ï¼šæœ¬æŠ¥å‘Šä¾æ®2025å¹´12æœˆ10æ—¥çŸ¥è¯†å›¾è°±ç³»ç»Ÿæ•°æ®ç”Ÿæˆï¼Œåç»­å¤„ç†éœ€ä»¥ç°åœºæ ¸å®ç»“æœä¸ºå‡†ã€‚å»ºè®®åŒæ­¥æ£€æŸ¥è¯¥è®¡é‡ç‚¹è¿‘6ä¸ªæœˆæŠ„è¡¨è®°å½•ï¼Œæ’æŸ¥ç³»ç»Ÿæ€§é£é™©ã€‚
            </div>
          </div>
        </div>
        <div class="demo-area">
          <div class="usage-examples">
            <div class="result-highlight">
              <h4>ğŸ¯ åˆ†æç»“æœ</h4>
              <!-- <p style="height: 300px; overflow: auto">
                  ç”µèƒ½è¡¨ç¤ºæ•°å¼‚å¸¸ç ”åˆ¤æŠ¥å‘Š ä¸€ã€å¼‚å¸¸åŸºæœ¬ä¿¡æ¯ é¡¹ç›® å†…å®¹ ç”¨æˆ·ç¼–å·
                  062170001751478 è®¡é‡ç‚¹ç¼–å· 0621700017514781 ç”¨æˆ·åç§° æœªæä¾›
                  å®¡æ ¸è§„åˆ™ç¼–å· TY-QW-DL-SS-06 è§„åˆ™åç§° ç”µèƒ½è¡¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•°
                  å¼‚å¸¸ç”µè´¹å¹´æœˆ 202512ï¼ˆ2025å¹´12æœˆï¼‰
                  äºŒã€ç ”åˆ¤ç»“è®ºnå­˜åœ¨çœŸå®å¼‚å¸¸ã€‚ç»æ ¸æŸ¥ç¡®è®¤ï¼Œè¯¥è®¡é‡ç‚¹2025å¹´12æœˆæŠ„è¡¨æ•°æ®å­˜åœ¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•°çš„è¿è§„æƒ…å†µï¼Œå±äºäººå·¥æŠ„å½•é”™è¯¯å¯¼è‡´çš„å¼‚å¸¸ã€‚
                  ä¸‰ã€åˆ¤æ–­è¿‡ç¨‹å’Œä¾æ®æ•°æ®éªŒè¯. 2025å¹´12æœˆæŠ„è¡¨æ•°æ®ï¼š -
                  ä¸Šæ¬¡è¡¨ç¤ºæ•°ï¼š150.12 - æœ¬æ¬¡è¡¨ç¤ºæ•°ï¼š149.34 -
                  è¡¨ç¤ºæ•°å·®é¢ï¼š0.78ï¼ˆæ­£å‘ç”µé‡ï¼‰ - æŠ„è¡¨å¼‚å¸¸ç±»åˆ«ï¼šå€’è½¬ -
                  å®é™…æŠ„è¡¨æ–¹å¼ï¼šæ‰‹å·¥æŠ„è¡¨n2. 2025å¹´11æœˆå¯¹æ¯”æ•°æ®ï¼š -
                  ä¸Šæ¬¡è¡¨ç¤ºæ•°ï¼š121.53 - æœ¬æ¬¡è¡¨ç¤ºæ•°ï¼š150.12 - æŠ„è¡¨æ–¹å¼ï¼šè¿œé‡‡é›†æŠ„#
                  è§„åˆ™åŒ¹é…åˆ†ænæ ¹æ®ã€ŠXXçœ-ç»Ÿæ¨è§„åˆ™æ€ç»´é“¾æ ‡æ³¨0527.xlsxã€‹ä¸­è§„åˆ™TY-QW-DL-SS-06çš„ç ”åˆ¤é€»è¾‘ï¼š-
                  è§¦å‘æ¡ä»¶ï¼šç»“ç®—è®¡é‡ç‚¹ä¸‹ç”µèƒ½è¡¨ç¤ºæ•°æœ¬æ¬¡å°äºä¸Šæ¬¡ï¼Œä¸”æŠ„è¡¨å¼‚å¸¸ç±»åˆ«â‰ 07ï¼ˆå¤±å‹ï¼‰-
                  æ‰‹å·¥æŠ„è¡¨åœºæ™¯åˆ¤å®šï¼š -
                  å½“å®é™…æŠ„è¡¨æ–¹å¼ä¸ºæ‰‹å·¥æŠ„è¡¨æ—¶ï¼Œæœ¬æ¬¡ç¤ºæ•°ä¸Šæ¬¡ç¤ºæ•°ç›´æ¥åˆ¤å®šä¸ºå¼‚å¸¸ -
                  æœ¬ä¾‹ä¸­æŠ„è¡¨æ–¹å¼æ˜ç¡®è®°å½•ä¸º"æ‰‹å·¥æŠ„è¡¨"ï¼Œä¸”æœ¬æ¬¡ç¤ºæ•°149.34
                  ä¸Šæ¬¡ç¤ºæ•°150.12 - è¿å"ä¸å¾—è¿è§„ä¼°æŠ„ã€æ¼æŠ„ã€é”™æŠ„"çš„åŸºæœ¬åŸåˆ™#
                  æ”¿ç­–åˆè§„æ€§éªŒè¯. å›½ç½‘è¥é”€è¥ä¸šã€”2023ã€•62å·æ–‡ç¬¬äºŒåä¸ƒæ¡ç¬¬å››æ¬¾ï¼š
                  "åŸåˆ™ä¸Šä¸å…è®¸æ‰‹å·¥å½•å…¥ï¼Œç‰¹æ®Šæƒ…å†µç¡®éœ€æ‰‹å·¥å½•å…¥çš„ï¼Œåº”ç”±å·¥ä½œäººå‘˜ç°åœºæŠ„å½•ã€æ‹ç…§ï¼Œå¹¶é€šè¿‡ç”¨ç”µä¿¡æ¯é‡‡é›†ç³»ç»Ÿä¸Šä¼ è¡¨è®¡ç¤ºæ•°ç…§ç‰‡ç­‰ä½è¯ææ–™ï¼Œå±¥è¡Œå®¡æ ¸æ‰‹ç»­"
                  Xç”µè¥é”€è§„ã€”2025ã€•4å·æ–‡ç¬¬äºŒåäº”æ¡ï¼š
                  "æŠ„è¡¨å‘¨æœŸå’ŒæŠ„è¡¨ä¾‹æ—¥åŸåˆ™ä¸Šä¸å…è®¸å˜æ›´...æŠ„è¡¨ç»“æŸå°†æ‰‹å·¥æŠ„å½•æ•°æ®å‡†ç¡®æ€§çº³å…¥è¥é”€ç¨½æŸ¥ä¸šåŠ¡èŒƒå›´"nç»“è®ºä¾æ®ï¼šè¯¥æ¡ˆä¾‹æ—¢æ— ä½è¯ææ–™ä¸Šä¼ è®°å½•ï¼Œä¹Ÿæœªå±¥è¡Œç‰¹æ®Šå®¡æ‰¹æ‰‹ç»­ï¼Œå±äºè¿è§„æ“ä½œã€‚
                  å››ã€å¼‚å¸¸åŸå› åˆ†æ. ç›´æ¥åŸå› ï¼š -
                  æŠ„è¡¨äººå‘˜åœ¨æ‰‹å·¥æŠ„å½•è¿‡ç¨‹ä¸­å‘ç”Ÿè¯»æ•°é”™è¯¯ï¼Œå°†150.34è¯¯è®°ä¸º149.34ï¼ˆæˆ–ç±»ä¼¼æ•°å­—æ··æ·†ï¼‰
                  - æœªæ‰§è¡Œ"ç°åœºæŠ„å½•ã€æ‹ç…§ä¸Šä¼ "çš„å¼ºåˆ¶è¦æ±‚ ç®¡ç†æ¼æ´ï¼š -
                  æ‰‹å·¥æŠ„è¡¨ç¯èŠ‚ç¼ºä¹æœ‰æ•ˆçš„åŒäººå¤æ ¸æœºåˆ¶ -
                  ç³»ç»Ÿæœªå¯¹äººå·¥å½•å…¥æ•°æ®è®¾ç½®é˜ˆå€¼é¢„è­¦ï¼ˆå¦‚ç¤ºæ•°ä¸‹é™è¶…è¿‡1%è‡ªåŠ¨æ‹¦æˆªï¼‰ -
                  æŠ„è¡¨è´¨é‡ç®¡æ§æœªè½å®"è°å‡ºå£ã€è°è´Ÿè´£"åŸåˆ™ æŠ€æœ¯å› ç´ ï¼š -
                  ä»è¿œé‡‡é›†æŠ„çªç„¶è½¬ä¸ºæ‰‹å·¥æŠ„è¡¨ï¼ˆ11æœˆä¸ºè¿œé‡‡ï¼Œ12æœˆä¸ºæ‰‹å·¥ï¼‰ï¼Œæœªè¿›è¡Œè®¡é‡è£…ç½®çŠ¶æ€æ£€æŸ¥
                  - æœªè¯†åˆ«ç”µè¡¨æ˜¯å¦å­˜åœ¨æœºæ¢°æ•…éšœå¯¼è‡´ç¤ºæ•°å¼‚å¸¸
                  äº”ã€å¤„ç†æªæ–½å’Œæ–¹æ¡ˆå»ºè®®ç´§æ€¥å¤„ç½®. ç°åœºå¤æ ¸ï¼š -
                  24å°æ—¶å†…å®‰æ’ä¸¤åå·¥ä½œäººå‘˜ç°åœºæ ¸å¯¹ç”µè¡¨ç¤ºæ•° -
                  æ‹æ‘„å¸¦æ—¶é—´æ°´å°çš„è¡¨è®¡ç…§ç‰‡ä½œä¸ºæ–°è¯æ®é“¾ æ•°æ®ä¿®æ­£ï¼š -
                  è‹¥ç¡®è®¤æŠ„å½•é”™è¯¯ï¼ŒæŒ‰æ­£ç¡®ç¤ºæ•°é‡æ–°è®¡ç®—ç”µè´¹ -
                  åœ¨ç³»ç»Ÿä¸­æ ‡æ³¨"äººå·¥ä¿®æ­£"å¹¶ç•™å­˜å®¡æ‰¹è®°å½•é•¿æ•ˆæœºåˆ¶ æªæ–½ç±»åˆ« å…·ä½“æ–¹æ¡ˆ
                  -------------------- æµç¨‹ä¼˜åŒ–
                  å»ºç«‹æ‰‹å·¥æŠ„è¡¨"åŒäººç¡®è®¤+å½±åƒä¸Šä¼ "å¼ºåˆ¶æµç¨‹ï¼Œç³»ç»Ÿè‡ªåŠ¨æ ¡éªŒå½±åƒå®Œæ•´æ€§
                  æŠ€æœ¯é˜²æ§
                  åœ¨é‡‡é›†ç³»ç»Ÿå¢åŠ ç¤ºæ•°çªå˜é¢„è­¦æ¨¡å—ï¼ˆè®¾ç½®Â±5%é˜ˆå€¼ï¼‰ï¼Œè‡ªåŠ¨å†»ç»“å¼‚å¸¸æ•°æ®
                  è´£ä»»è¿½æº¯
                  å°†æŠ„è¡¨å·®é”™çº³å…¥ç»©æ•ˆè€ƒæ ¸ï¼Œå®è¡Œ"å·®é”™æº¯æº-è´£ä»»è®¤å®š-ç»æµå¤„ç½š"é—­ç¯ç®¡ç†
                  åŸ¹è®­å¼ºåŒ–
                  å¼€å±•æŠ„è¡¨äººå‘˜ä¸“é¡¹åŸ¹è®­ï¼Œé‡ç‚¹å¼ºåŒ–æ•°å­—è¯†åˆ«èƒ½åŠ›å’Œè§„èŒƒæ“ä½œæ„è¯†
                  é€€è¡¥æ–¹æ¡ˆ. æŒ‰ã€Šè¥ä¸šå·®é”™é€€è¡¥ç®¡ç†åŠæ³•ã€‹å¯åŠ¨é€€è¡¥æµç¨‹ è®¡ç®—å…¬å¼ï¼š
                  `åº”é€€è¡¥ç”µè´¹ = (æ­£ç¡®ç¤ºæ•° - é”™è¯¯ç¤ºæ•°) Ã— ç»¼åˆå€ç‡ Ã— ç”µä»·` `=
                  (150.34 - 149.34) Ã— 1 Ã— 38.99å…ƒ/kWh = 38.99å…ƒ`.
                  3ä¸ªå·¥ä½œæ—¥å†…å®Œæˆå®¢æˆ·æ²Ÿé€šå’Œè´¦åŠ¡è°ƒæ•´ å…­ã€ç›¸å…³æ–‡ä»¶åŠæ³•å’Œè§„å®š.
                  æ ¸å¿ƒä¾æ®ï¼š -
                  ã€Šå›½ç½‘è¥é”€éƒ¨å…³äºå°å‘ã€ˆç”µè´¹ä¸šåŠ¡ç®¡ç†åŠæ³•ï¼ˆè¯•è¡Œï¼‰ã€‰çš„é€šçŸ¥ã€‹ï¼ˆè¥é”€è¥ä¸šã€”2023ã€•62å·ï¼‰
                  - ç¬¬äºŒåå…­æ¡ï¼šæŠ„è¡¨æ•°æ®"è°å‡ºå£ã€è°è´Ÿè´£"è´¨é‡ç®¡ç†è¦æ±‚ -
                  ç¬¬äºŒåä¸ƒæ¡ç¬¬å››æ¬¾ï¼šæ‰‹å·¥æŠ„è¡¨çš„ç‰¹æ®Šç®¡ç†è§„å®š -
                  ç¬¬äº”åå…«æ¡ï¼šè¥ä¸šå·®é”™é€€è¡¥å¤„ç†è§„èŒƒ åœ°æ–¹å®æ–½ç»†åˆ™ï¼š -
                  ã€Šå›½ç½‘XXçœç”µåŠ›æœ‰é™å…¬å¸ç”µè´¹æ ¸ç®—ç®¡ç†åŠæ³•ã€‹ï¼ˆXç”µè¥é”€è§„ã€”2025ã€•4å·ï¼‰
                  - ç¬¬äºŒåå››æ¡ï¼šæ‰‹å·¥æŠ„è¡¨æ•°æ®å¿…é¡»é™„å½±åƒä½è¯ -
                  ç¬¬äºŒåäº”æ¡ï¼šæŠ„è¡¨è´¨é‡çº³å…¥è¥é”€ç¨½æŸ¥èŒƒå›´ é…å¥—æ ‡å‡†ï¼š -
                  ã€Šç”¨ç”µä¿¡æ¯é‡‡é›†ç³»ç»Ÿè¿è¡Œç»´æŠ¤è§„ç¨‹ã€‹Q/GDW 12202-2024 -
                  ã€Šç”µåŠ›è¥é”€ç°åœºä½œä¸šå®‰å…¨å·¥ä½œè§„ç¨‹ã€‹Q/GDW 1799.2-2023>
                  å¤‡æ³¨ï¼šæœ¬æŠ¥å‘Šä¾æ®2025å¹´12æœˆ10æ—¥çŸ¥è¯†å›¾è°±ç³»ç»Ÿæ•°æ®ç”Ÿæˆï¼Œåç»­å¤„ç†éœ€ä»¥ç°åœºæ ¸å®ç»“æœä¸ºå‡†ã€‚å»ºè®®åŒæ­¥æ£€æŸ¥è¯¥è®¡é‡ç‚¹è¿‘6ä¸ªæœˆæŠ„è¡¨è®°å½•ï¼Œæ’æŸ¥ç³»ç»Ÿæ€§é£é™©ã€‚
                </p> -->
              <div class="markdown-container" v-html="renderedMarkdown"></div>
            </div>
          </div>
        </div>
        <div style="display: flex; justify-content: center; margin-top: 12px">
          <el-button @click="submitted" type="primary">å¼‚å¸¸å·¥å•ä¸‹å‘</el-button>
          <el-button @click="back">è¿”å›</el-button>
        </div>
      </div>
    </el-main>
  </el-container>
</template>

<script>
import { marked } from "marked";
import hljs from "highlight.js";
export default {
  name: "App",
  data() {
    return {
      queryKey: "", // æŸ¥è¯¢å…³é”®è¯
      userNamber: "", // æŸ¥è¯¢å…³é”®è¯
      voltageLevel: "", // æŸ¥è¯¢å…³é”®è¯
      powerSupplyUnit: "", // æŸ¥è¯¢å…³é”®è¯
      date: "", // æŸ¥è¯¢å…³é”®è¯
      activeName: "first",
      // åŸå§‹æ•°æ®ï¼ˆæ¨¡æ‹Ÿåç«¯è¿”å›ï¼‰
      originalData: [
        {
          name: "å¼ èŠ³",
          mgtOrgName: "å›½ç½‘å››å·æˆéƒ½é”¦æ±Ÿä¸­å¿ƒ",
          userId: "062170001751478",
          ruleTriggered: "TY-QW-DL-SS-06",
          ruleName: "ç”µèƒ½è¡¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•°",
          yearMonth: "2025-12",
          chkCalcPic: "H0003518258",
          position: "ç”µåŠ›ä¾›åº”",
          department: "220V",
          thisMonthQty: "285888",
          lastMonthQty: "250966",
          lastMonusQty: "34922",
          lastMonthRate: "13.92%",
          abnormal: "1",
        },
        {
          name: "åˆ˜å®‡",
          mgtOrgName: "å›½ç½‘å››å·æˆéƒ½é”¦æ±Ÿä¸­å¿ƒ",
          userId: "062170001751479",
          ruleName: "ç”µèƒ½è¡¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•°",
          ruleTriggered: "TY-QW-DL-SS-06",
          yearMonth: "2025-12",
          chkCalcPic: "H0003518268",
          position: "ç”µåŠ›ä¾›åº”",
          department: "380V",
          thisMonthQty: "0",
          lastMonthQty: "0",
          lastMonusQty: "0",
          lastMonthRate: "0%",
          abnormal: "1",
        },
        {
          name: "åˆ˜å®‡",
          mgtOrgName: "å›½ç½‘å››å·æˆéƒ½é”¦æ±Ÿä¸­å¿ƒ",
          userId: "062170001751480",
          ruleName: "ç”µèƒ½è¡¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•°",
          ruleTriggered: "TY-QW-DL-SS-06",
          yearMonth: "2025-12",
          chkCalcPic: "H0003518253",
          position: "ç”µåŠ›ç”Ÿäº§",
          department: "380V",
          thisMonthQty: "26536",
          lastMonthQty: "20299",
          lastMonusQty: "6237",
          lastMonthRate: "30.73%",
          abnormal: "0",
        },
        {
          name: "å¼ èŠ³",
          mgtOrgName: "å›½ç½‘å››å·æˆéƒ½é”¦æ±Ÿä¸­å¿ƒ",
          userId: "062170001751481",
          ruleName: "ç”µèƒ½è¡¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•°",
          ruleTriggered: "TY-QW-DL-SS-06",
          yearMonth: "2025-12",
          chkCalcPic: "H0003518255",
          position: "ç”µåŠ›ç”Ÿäº§",
          department: "220V",
          thisMonthQty: "58824",
          lastMonthQty: "49464",
          lastMonusQty: "9360",
          lastMonthRate: "18.92%",
          abnormal: "1",
        },
        {
          name: "å¼ èŠ³",
          mgtOrgName: "å›½ç½‘å››å·æˆéƒ½é”¦æ±Ÿä¸­å¿ƒ",
          userId: "0306030002228832",
          ruleName: "å·¥å•†ä¸šè®¡é‡ç‚¹è´¹ç”¨ç±»å‹ç¼ºå¤±",
          ruleTriggered: "TY-QW-DF-SP-01",
          yearMonth: "2025-12",
          chkCalcPic: "H0003518255",
          position: "ç”µåŠ›ç”Ÿäº§",
          department: "220V",
          thisMonthQty: "58824",
          lastMonthQty: "49464",
          lastMonusQty: "9360",
          lastMonthRate: "18.92%",
          abnormal: "0",
        },
        {
          name: "å¼ èŠ³",
          mgtOrgName: "å›½ç½‘å››å·æˆéƒ½é”¦æ±Ÿä¸­å¿ƒ",
          userId: "0306030002228831",
          ruleName: "æ— æŠ„è§ç”µé‡æœ‰åŸºæœ¬ç”µè´¹",
          ruleTriggered: "JD_11",
          yearMonth: "2025-12",
          chkCalcPic: "H0003518255",
          position: "ç”µåŠ›ç”Ÿäº§",
          department: "220V",
          thisMonthQty: "58824",
          lastMonthQty: "49464",
          lastMonusQty: "9360",
          lastMonthRate: "18.92%",
          abnormal: "1",
        },
        {
          name: "å¼ èŠ³",
          mgtOrgName: "å›½ç½‘å››å·æˆéƒ½é”¦æ±Ÿä¸­å¿ƒ",
          userId: "0306030002228833",
          ruleName: "æ— æŠ„è§ç”µé‡æœ‰åŸºæœ¬ç”µè´¹",
          ruleTriggered: "JD_11",
          yearMonth: "2025-12",
          chkCalcPic: "H0003518255",
          position: "ç”µåŠ›ç”Ÿäº§",
          department: "220V",
          thisMonthQty: "58824",
          lastMonthQty: "49464",
          lastMonusQty: "9360",
          lastMonthRate: "18.92%",
          abnormal: "1",
        },
        {
          name: "å¼ èŠ³",
          mgtOrgName: "å›½ç½‘å››å·æˆéƒ½é”¦æ±Ÿä¸­å¿ƒ",
          userId: "0306030002228834",
          ruleName: "æ— æŠ„è§ç”µé‡æœ‰åŸºæœ¬ç”µè´¹",
          ruleTriggered: "JD_11",
          yearMonth: "2025-12",
          chkCalcPic: "H0003518255",
          position: "ç”µåŠ›ç”Ÿäº§",
          department: "220V",
          thisMonthQty: "58824",
          lastMonthQty: "49464",
          lastMonusQty: "9360",
          lastMonthRate: "18.92%",
          abnormal: "0",
        },
      ],
      tableData: [], // è¿‡æ»¤åçš„è¡¨æ ¼æ•°æ®
      showTime: "1",
      options: [
        {
          value: "é€‰é¡¹1",
          label: "é»„é‡‘ç³•",
        },
        {
          value: "é€‰é¡¹2",
          label: "åŒçš®å¥¶",
        },
        {
          value: "é€‰é¡¹3",
          label: "èšµä»”ç…",
        },
        {
          value: "é€‰é¡¹4",
          label: "é¾™é¡»é¢",
        },
        {
          value: "é€‰é¡¹5",
          label: "åŒ—äº¬çƒ¤é¸­",
        },
      ],
      rowObj: {},
      borderShow: "2",
      tabShow: "1",
      markdownSource: `# ç”µèƒ½è¡¨ç¤ºæ•°å¼‚å¸¸ç ”åˆ¤æŠ¥å‘Š
  
  ## ä¸€ã€å¼‚å¸¸åŸºæœ¬ä¿¡æ¯
  
  | é¡¹ç›® | å†…å®¹ |
  |------|------|
  | ç”¨æˆ·ç¼–å· | 062170001751478 |
  | è®¡é‡ç‚¹ç¼–å· | 0621700017514781 |
  | ç”¨æˆ·åç§° | æœªæä¾› |
  | å®¡æ ¸è§„åˆ™ç¼–å· | TY-QW-DL-SS-06 |
  | è§„åˆ™åç§° | ç”µèƒ½è¡¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•° |
  | å¼‚å¸¸ç”µè´¹å¹´æœˆ | 202512ï¼ˆ2025å¹´12æœˆï¼‰ |
  
  ## äºŒã€ç ”åˆ¤ç»“è®º
  
  **å­˜åœ¨çœŸå®å¼‚å¸¸**ã€‚ç»æ ¸æŸ¥ç¡®è®¤ï¼Œè¯¥è®¡é‡ç‚¹2025å¹´12æœˆæŠ„è¡¨æ•°æ®å­˜åœ¨æœ¬æ¬¡ç¤ºæ•°å°äºä¸Šæ¬¡ç¤ºæ•°çš„è¿è§„æƒ…å†µï¼Œå±äºäººå·¥æŠ„å½•é”™è¯¯å¯¼è‡´çš„å¼‚å¸¸ã€‚
  
  ## ä¸‰ã€åˆ¤æ–­è¿‡ç¨‹å’Œä¾æ®
  
  ### æ•°æ®éªŒè¯
  1. **2025å¹´12æœˆæŠ„è¡¨æ•°æ®**ï¼š
     - ä¸Šæ¬¡è¡¨ç¤ºæ•°ï¼š150.12
     - æœ¬æ¬¡è¡¨ç¤ºæ•°ï¼š149.34
     - è¡¨ç¤ºæ•°å·®é¢ï¼š0.78ï¼ˆæ­£å‘ç”µé‡ï¼‰
     - æŠ„è¡¨å¼‚å¸¸ç±»åˆ«ï¼šå€’è½¬
     - å®é™…æŠ„è¡¨æ–¹å¼ï¼šæ‰‹å·¥æŠ„è¡¨
  
  2. **2025å¹´11æœˆå¯¹æ¯”æ•°æ®**ï¼š
     - ä¸Šæ¬¡è¡¨ç¤ºæ•°ï¼š121.53
     - æœ¬æ¬¡è¡¨ç¤ºæ•°ï¼š150.12
     - æŠ„è¡¨æ–¹å¼ï¼šè¿œé‡‡é›†æŠ„
  
  ### è§„åˆ™åŒ¹é…åˆ†æ
  æ ¹æ®ã€ŠXXçœ-ç»Ÿæ¨è§„åˆ™æ€ç»´é“¾æ ‡æ³¨0527.xlsxã€‹ä¸­è§„åˆ™TY-QW-DL-SS-06çš„ç ”åˆ¤é€»è¾‘ï¼š
  - **è§¦å‘æ¡ä»¶**ï¼šç»“ç®—è®¡é‡ç‚¹ä¸‹ç”µèƒ½è¡¨ç¤ºæ•°æœ¬æ¬¡å°äºä¸Šæ¬¡ï¼Œä¸”æŠ„è¡¨å¼‚å¸¸ç±»åˆ«â‰ 07ï¼ˆå¤±å‹ï¼‰
  - **æ‰‹å·¥æŠ„è¡¨åœºæ™¯åˆ¤å®š**ï¼š
    - å½“å®é™…æŠ„è¡¨æ–¹å¼ä¸ºæ‰‹å·¥æŠ„è¡¨æ—¶ï¼Œæœ¬æ¬¡ç¤ºæ•°<ä¸Šæ¬¡ç¤ºæ•°ç›´æ¥åˆ¤å®šä¸ºå¼‚å¸¸
    - æœ¬ä¾‹ä¸­æŠ„è¡¨æ–¹å¼æ˜ç¡®è®°å½•ä¸º"æ‰‹å·¥æŠ„è¡¨"ï¼Œä¸”æœ¬æ¬¡ç¤ºæ•°149.34 < ä¸Šæ¬¡ç¤ºæ•°150.12
    - è¿å"ä¸å¾—è¿è§„ä¼°æŠ„ã€æ¼æŠ„ã€é”™æŠ„"çš„åŸºæœ¬åŸåˆ™
  
  ### æ”¿ç­–åˆè§„æ€§éªŒè¯
  1. **å›½ç½‘è¥é”€è¥ä¸šã€”2023ã€•62å·æ–‡ç¬¬äºŒåä¸ƒæ¡ç¬¬å››æ¬¾**ï¼š
     > "åŸåˆ™ä¸Šä¸å…è®¸æ‰‹å·¥å½•å…¥ï¼Œç‰¹æ®Šæƒ…å†µç¡®éœ€æ‰‹å·¥å½•å…¥çš„ï¼Œåº”ç”±å·¥ä½œäººå‘˜ç°åœºæŠ„å½•ã€æ‹ç…§ï¼Œå¹¶é€šè¿‡ç”¨ç”µä¿¡æ¯é‡‡é›†ç³»ç»Ÿä¸Šä¼ è¡¨è®¡ç¤ºæ•°ç…§ç‰‡ç­‰ä½è¯ææ–™ï¼Œå±¥è¡Œå®¡æ ¸æ‰‹ç»­"
  
  2. **Xç”µè¥é”€è§„ã€”2025ã€•4å·æ–‡ç¬¬äºŒåäº”æ¡**ï¼š
     > "æŠ„è¡¨å‘¨æœŸå’ŒæŠ„è¡¨ä¾‹æ—¥åŸåˆ™ä¸Šä¸å…è®¸å˜æ›´...æŠ„è¡¨ç»“æŸå°†æ‰‹å·¥æŠ„å½•æ•°æ®å‡†ç¡®æ€§çº³å…¥è¥é”€ç¨½æŸ¥ä¸šåŠ¡èŒƒå›´"
  
  **ç»“è®ºä¾æ®**ï¼šè¯¥æ¡ˆä¾‹æ—¢æ— ä½è¯ææ–™ä¸Šä¼ è®°å½•ï¼Œä¹Ÿæœªå±¥è¡Œç‰¹æ®Šå®¡æ‰¹æ‰‹ç»­ï¼Œå±äºè¿è§„æ“ä½œã€‚
  
  ## å››ã€å¼‚å¸¸åŸå› åˆ†æ
  
  1. **ç›´æ¥åŸå› **ï¼š
     - æŠ„è¡¨äººå‘˜åœ¨æ‰‹å·¥æŠ„å½•è¿‡ç¨‹ä¸­å‘ç”Ÿè¯»æ•°é”™è¯¯ï¼Œå°†150.34è¯¯è®°ä¸º149.34ï¼ˆæˆ–ç±»ä¼¼æ•°å­—æ··æ·†ï¼‰
     - æœªæ‰§è¡Œ"ç°åœºæŠ„å½•ã€æ‹ç…§ä¸Šä¼ "çš„å¼ºåˆ¶è¦æ±‚
  
  2. **ç®¡ç†æ¼æ´**ï¼š
     - æ‰‹å·¥æŠ„è¡¨ç¯èŠ‚ç¼ºä¹æœ‰æ•ˆçš„åŒäººå¤æ ¸æœºåˆ¶
     - ç³»ç»Ÿæœªå¯¹äººå·¥å½•å…¥æ•°æ®è®¾ç½®é˜ˆå€¼é¢„è­¦ï¼ˆå¦‚ç¤ºæ•°ä¸‹é™è¶…è¿‡1%è‡ªåŠ¨æ‹¦æˆªï¼‰
     - æŠ„è¡¨è´¨é‡ç®¡æ§æœªè½å®"è°å‡ºå£ã€è°è´Ÿè´£"åŸåˆ™
  
  3. **æŠ€æœ¯å› ç´ **ï¼š
     - ä»è¿œé‡‡é›†æŠ„çªç„¶è½¬ä¸ºæ‰‹å·¥æŠ„è¡¨ï¼ˆ11æœˆä¸ºè¿œé‡‡ï¼Œ12æœˆä¸ºæ‰‹å·¥ï¼‰ï¼Œæœªè¿›è¡Œè®¡é‡è£…ç½®çŠ¶æ€æ£€æŸ¥
     - æœªè¯†åˆ«ç”µè¡¨æ˜¯å¦å­˜åœ¨æœºæ¢°æ•…éšœå¯¼è‡´ç¤ºæ•°å¼‚å¸¸
  
  ## äº”ã€å¤„ç†æªæ–½å’Œæ–¹æ¡ˆå»ºè®®
  
  ### ç´§æ€¥å¤„ç½®
  1. **ç°åœºå¤æ ¸**ï¼š
     - 24å°æ—¶å†…å®‰æ’ä¸¤åå·¥ä½œäººå‘˜ç°åœºæ ¸å¯¹ç”µè¡¨ç¤ºæ•°
     - æ‹æ‘„å¸¦æ—¶é—´æ°´å°çš„è¡¨è®¡ç…§ç‰‡ä½œä¸ºæ–°è¯æ®é“¾
  
  2. **æ•°æ®ä¿®æ­£**ï¼š
     - è‹¥ç¡®è®¤æŠ„å½•é”™è¯¯ï¼ŒæŒ‰æ­£ç¡®ç¤ºæ•°é‡æ–°è®¡ç®—ç”µè´¹
     - åœ¨ç³»ç»Ÿä¸­æ ‡æ³¨"äººå·¥ä¿®æ­£"å¹¶ç•™å­˜å®¡æ‰¹è®°å½•
  
  ### é•¿æ•ˆæœºåˆ¶
  | æªæ–½ç±»åˆ« | å…·ä½“æ–¹æ¡ˆ |
  |----------|----------|
  | **æµç¨‹ä¼˜åŒ–** | å»ºç«‹æ‰‹å·¥æŠ„è¡¨"åŒäººç¡®è®¤+å½±åƒä¸Šä¼ "å¼ºåˆ¶æµç¨‹ï¼Œç³»ç»Ÿè‡ªåŠ¨æ ¡éªŒå½±åƒå®Œæ•´æ€§ |
  | **æŠ€æœ¯é˜²æ§** | åœ¨é‡‡é›†ç³»ç»Ÿå¢åŠ ç¤ºæ•°çªå˜é¢„è­¦æ¨¡å—ï¼ˆè®¾ç½®Â±5%é˜ˆå€¼ï¼‰ï¼Œè‡ªåŠ¨å†»ç»“å¼‚å¸¸æ•°æ® |
  | **è´£ä»»è¿½æº¯** | å°†æŠ„è¡¨å·®é”™çº³å…¥ç»©æ•ˆè€ƒæ ¸ï¼Œå®è¡Œ"å·®é”™æº¯æº-è´£ä»»è®¤å®š-ç»æµå¤„ç½š"é—­ç¯ç®¡ç† |
  | **åŸ¹è®­å¼ºåŒ–** | å¼€å±•æŠ„è¡¨äººå‘˜ä¸“é¡¹åŸ¹è®­ï¼Œé‡ç‚¹å¼ºåŒ–æ•°å­—è¯†åˆ«èƒ½åŠ›å’Œè§„èŒƒæ“ä½œæ„è¯† |
  
  ### é€€è¡¥æ–¹æ¡ˆ
  1. æŒ‰ã€Šè¥ä¸šå·®é”™é€€è¡¥ç®¡ç†åŠæ³•ã€‹å¯åŠ¨é€€è¡¥æµç¨‹
  2. è®¡ç®—å…¬å¼ï¼š
     \`åº”é€€è¡¥ç”µè´¹ = (æ­£ç¡®ç¤ºæ•° - é”™è¯¯ç¤ºæ•°) Ã— ç»¼åˆå€ç‡ Ã— ç”µä»·\`
     \`= (150.34 - 149.34) Ã— 1 Ã— 38.99å…ƒ/kWh = 38.99å…ƒ\`
  3. 3ä¸ªå·¥ä½œæ—¥å†…å®Œæˆå®¢æˆ·æ²Ÿé€šå’Œè´¦åŠ¡è°ƒæ•´
  
  ## å…­ã€ç›¸å…³æ–‡ä»¶åŠæ³•å’Œè§„å®š
  
  1. **æ ¸å¿ƒä¾æ®**ï¼š
     - ã€Šå›½ç½‘è¥é”€éƒ¨å…³äºå°å‘ã€ˆç”µè´¹ä¸šåŠ¡ç®¡ç†åŠæ³•ï¼ˆè¯•è¡Œï¼‰ã€‰çš„é€šçŸ¥ã€‹ï¼ˆè¥é”€è¥ä¸šã€”2023ã€•62å·ï¼‰
       - ç¬¬äºŒåå…­æ¡ï¼šæŠ„è¡¨æ•°æ®"è°å‡ºå£ã€è°è´Ÿè´£"è´¨é‡ç®¡ç†è¦æ±‚
       - ç¬¬äºŒåä¸ƒæ¡ç¬¬å››æ¬¾ï¼šæ‰‹å·¥æŠ„è¡¨çš„ç‰¹æ®Šç®¡ç†è§„å®š
       - ç¬¬äº”åå…«æ¡ï¼šè¥ä¸šå·®é”™é€€è¡¥å¤„ç†è§„èŒƒ
  
  2. **åœ°æ–¹å®æ–½ç»†åˆ™**ï¼š
     - ã€Šå›½ç½‘XXçœç”µåŠ›æœ‰é™å…¬å¸ç”µè´¹æ ¸ç®—ç®¡ç†åŠæ³•ã€‹ï¼ˆXç”µè¥é”€è§„ã€”2025ã€•4å·ï¼‰
       - ç¬¬äºŒåå››æ¡ï¼šæ‰‹å·¥æŠ„è¡¨æ•°æ®å¿…é¡»é™„å½±åƒä½è¯
       - ç¬¬äºŒåäº”æ¡ï¼šæŠ„è¡¨è´¨é‡çº³å…¥è¥é”€ç¨½æŸ¥èŒƒå›´
  
  3. **é…å¥—æ ‡å‡†**ï¼š
     - ã€Šç”¨ç”µä¿¡æ¯é‡‡é›†ç³»ç»Ÿè¿è¡Œç»´æŠ¤è§„ç¨‹ã€‹Q/GDW 12202-2024
     - ã€Šç”µåŠ›è¥é”€ç°åœºä½œä¸šå®‰å…¨å·¥ä½œè§„ç¨‹ã€‹Q/GDW 1799.2-2023
  
  > **å¤‡æ³¨**ï¼šæœ¬æŠ¥å‘Šä¾æ®2025å¹´12æœˆ10æ—¥çŸ¥è¯†å›¾è°±ç³»ç»Ÿæ•°æ®ç”Ÿæˆï¼Œåç»­å¤„ç†éœ€ä»¥ç°åœºæ ¸å®ç»“æœä¸ºå‡†ã€‚å»ºè®®åŒæ­¥æ£€æŸ¥è¯¥è®¡é‡ç‚¹è¿‘6ä¸ªæœˆæŠ„è¡¨è®°å½•ï¼Œæ’æŸ¥ç³»ç»Ÿæ€§é£é™©ã€‚`,
      // è§£æåçš„ HTML å­—ç¬¦ä¸²
      renderedMarkdown: "",
    };
  },
  watch: {},
  mounted() {
    // åˆå§‹åŒ–è¡¨æ ¼æ•°æ®
    this.originalData.map((item) => {
      if (item.abnormal == "0") {
        item.abnormal = "æ— å¼‚å¸¸";
      }
      if (item.abnormal == "1") {
        item.abnormal = "å¼‚å¸¸";
      }
    });
    this.tableData = [...this.originalData];
  },
  methods: {
    // æŸ¥è¯¢æ–¹æ³•ï¼šæ ¹æ®å…³é”®è¯è¿‡æ»¤æ•°æ®
    renderMarkdownContent() {
      // é…ç½® markedï¼Œç¡®ä¿æ‰€æœ‰ MD æ ¼å¼éƒ½èƒ½æ­£ç¡®è§£æ
      marked.setOptions({
        // ä»£ç å—é«˜äº®é…ç½®
        highlight: (code, lang) => {
          if (lang && hljs.getLanguage(lang)) {
            return hljs.highlight(code, { language: lang }).value;
          }
          return hljs.highlightAuto(code).value;
        },
        gfm: true, // å¼€å¯ GitHub é£æ ¼ MDï¼ˆæ”¯æŒè¡¨æ ¼ã€ä»»åŠ¡åˆ—è¡¨ç­‰ï¼‰
        breaks: true, // æ¢è¡Œç¬¦è½¬ <br>
        sanitize: true, // å¼€å¯ XSS é˜²æŠ¤
        tables: true, // å¼ºåˆ¶å¼€å¯è¡¨æ ¼è§£æï¼ˆç¡®ä¿ä½ çš„è¡¨æ ¼èƒ½æ˜¾ç¤ºï¼‰
        headerIds: false, // å…³é—­è‡ªåŠ¨ç”Ÿæˆæ ‡é¢˜ IDï¼ˆé¿å…å¤šä½™å…ƒç´ ï¼‰
      });

      // è§£æ MD ä¸º HTML
      this.renderedMarkdown = marked.parse(this.markdownSource);
    },
    search() {
      if (!this.queryKey) {
        this.tableData = [...this.originalData];
        return;
      }
      // æ¨¡ç³ŠåŒ¹é…å§“å/èŒä½ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
      this.tableData = this.originalData.filter((item) => {
        const key = this.queryKey.toLowerCase();
        return (
          item.name.toLowerCase().includes(key) ||
          item.position.toLowerCase().includes(key)
        );
      });
    },
    handleClick() {},
    borderClick() {
      this.borderShow = "2";
    },
    bordersClick() {
      this.borderShow = "1";
    },
    handleDetail(row) {
      this.showTime = "2";
      this.rowObj = row;
      this.renderMarkdownContent();
    },
    submitted() {
      this.$confirm("æ­¤æ“ä½œå°†è¿›è¡Œå¼‚å¸¸å·¥å•ä¸‹å‘ä»¶, æ˜¯å¦ç»§ç»­?", "æç¤º", {
        confirmButtonText: "ç¡®å®š",
        cancelButtonText: "å–æ¶ˆ",
        type: "warning",
      })
        .then(() => {
          this.$message({
            type: "success",
            message: "ä¸‹å‘æˆåŠŸ!",
          });
        })
        .catch(() => {
          this.$message({
            type: "info",
            message: "å·²å–æ¶ˆä¸‹å‘",
          });
        });
    },
    back() {
      this.showTime = "1";
    },
    // é‡ç½®æŸ¥è¯¢
    reset() {
      this.queryKey = "";
      this.tableData = [...this.originalData];
    },
  },
};
</script>

<style scoped>
body {
  margin: 0;
}
.app-container {
  max-width: 1200px;
  margin: 0 auto;
}

/* å»é™¤å¯¼èˆªèœå•é»˜è®¤çš„å¤–è¾¹è·ï¼Œä¼˜åŒ–æ ·å¼ */
:deep(.el-menu-vertical-demo) {
  border-right: none;
}

/* å¤–å±‚å®¹å™¨é“ºæ»¡è§†å£é«˜åº¦ */
.el-container {
  /* background-color: #f5f7fa; */
}
.demo-area {
  display: flex;
  flex-direction: column;
  gap: 30px;
}

.result-highlight {
  margin-top: 20px;
  padding: 15px;
  /* background-color: #f0f9ff; */
  border-radius: 8px;
  /* border-left: 4px solid #409eff; */
}

.result-highlight h4 {
  color: #409eff;
  margin-bottom: 10px;
}
.border-content {
  cursor: pointer;
  border: 1px solid #ebebeb;
  border-radius: 12px;
  padding: 10px;
  margin-top: 12px;
}
.markdown-container {
  max-width: 800px;
  margin: 20px auto;
  padding: 0 20px;
  line-height: 1.8;
  font-size: 14px;
}
/* æ•´ä½“å®¹å™¨æ ·å¼ï¼Œé€‚é…æ–‡æ¡£é˜…è¯» */
.markdown-report-container {
  max-width: 1000px;
  margin: 20px auto;
  padding: 20px 30px;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  font-size: 14px;
  line-height: 1.8;
  color: #333;
}

/* æ ‡é¢˜æ ·å¼ä¼˜åŒ– */
.markdown-report-container h1 {
  font-size: 22px;
  color: #2c3e50;
  border-bottom: 1px solid #eaecef;
  padding-bottom: 8px;
  margin: 30px 0 15px 0;
}

.markdown-report-container h2 {
  font-size: 18px;
  color: #2c3e50;
  margin: 25px 0 12px 0;
}

.markdown-report-container h3 {
  font-size: 16px;
  color: #2c3e50;
  margin: 20px 0 10px 0;
}

/* è¡¨æ ¼æ ·å¼ï¼ˆæ ¸å¿ƒï¼šè®©ä½ çš„ä¸¤ä¸ªè¡¨æ ¼æ¸…æ™°æ˜¾ç¤ºï¼‰ */
.markdown-report-container table {
  width: 100%;
  border-collapse: collapse;
  margin: 15px 0;
  background: #fff;
}

.markdown-report-container th,
.markdown-report-container td {
  padding: 10px 12px;
  border: 1px solid #d0d7de;
  text-align: left;
}

.markdown-report-container th {
  background: #f6f8fa;
  font-weight: 600;
}

/* åˆ—è¡¨æ ·å¼ */
.markdown-report-container ul,
.markdown-report-container ol {
  padding-left: 20px;
  margin: 8px 0;
}

.markdown-report-container li {
  margin: 4px 0;
}

/* ç²—ä½“æ ·å¼ */
.markdown-report-container strong {
  color: #2c3e50;
  font-weight: 600;
}

/* å¼•ç”¨å—æ ·å¼ï¼ˆä½ çš„æ”¿ç­–æ¡æ–‡å¼•ç”¨ï¼‰ */
.markdown-report-container blockquote {
  margin: 10px 0;
  padding: 10px 15px;
  border-left: 4px solid #4299e1;
  background: #f5f8ff;
  color: #4a5568;
}

/* ä»£ç å—æ ·å¼ï¼ˆä½ çš„è®¡ç®—å…¬å¼ï¼‰ */
.markdown-report-container pre {
  padding: 12px;
  border-radius: 6px;
  overflow-x: auto;
  background: #f6f8fa !important;
  margin: 8px 0;
}

.markdown-report-container code {
  padding: 2px 4px;
  border-radius: 3px;
  background: #f6f8fa;
  font-size: 13px;
  color: #e53e3e;
}

/* æ®µè½é—´è· */
.markdown-report-container p {
  margin: 8px 0;
}
</style>
